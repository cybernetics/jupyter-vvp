language: python
services: docker

install:
- pip install -r requirements.txt

script:
- python -m unittest
- python setup.py sdist
- docker build -t eu.gcr.io/vvp-devel-240810/vvp-jupyter:latest .

deploy:
  provider: script
  script: bash dev/scripts/deploy.sh
  skip_cleanup: true
  on:
    all_branches: true
    condition: $TRAVIS_BRANCH =~ ^(master|release-.*)$ || -n $TRAVIS_TAG